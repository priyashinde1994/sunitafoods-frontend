<div class="container mt-5">
  <h2 class="text-center mb-4">üõ†Ô∏è Admin Dashboard</h2>
  <div class="d-flex justify-content-end mb-3">
    <button class="btn btn-outline-danger" (click)="logout()">üîí Logout</button>
  </div>

  <!-- Existing cards -->
  <div class="row g-4 justify-content-center mb-5">
    <div class="col-md-4">
      <div class="card shadow-sm h-100 text-center">
        <div class="card-body">
          <h5 class="card-title">üì¶ Manage Products</h5>
          <p class="card-text">View, edit, activate/deactivate, or delete products.</p>
          <a routerLink="/admin/products" class="btn btn-primary w-100">Go to Products</a>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow-sm h-100 text-center">
        <div class="card-body">
          <h5 class="card-title">‚ûï Add Product</h5>
          <p class="card-text">Add new products to your catalog.</p>
          <a routerLink="/admin/add-product" class="btn btn-success w-100">Add Product</a>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow-sm h-100 text-center">
        <div class="card-body">
          <h5 class="card-title">üìä Reports (Future)</h5>
          <p class="card-text">Analytics and sales reports (coming soon).</p>
          <button class="btn btn-secondary w-100" disabled>Coming Soon</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Orders Section -->
  <h3 class="mb-3">üìë Orders Management</h3>

  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

  <table class="table table-bordered table-striped" *ngIf="orders && orders.length > 0">
    <thead class="table-light">
      <tr>
        <th>ID</th>
        <th>Customer</th>
        <th>Email</th>
        <th>Phone</th>
        <th>Total Amount</th>
        <th>Status</th>
        <th>Created At</th>
        <th>Address</th>
        <th>Items</th>
        <th>Change Status</th>
      </tr>
      <!-- ‚úÖ Filter row -->
      <tr>
        <th>
          <input
            class="form-control form-control-sm"
            [(ngModel)]="filters.id"
            placeholder="Filter ID"
          />
        </th>
        <th>
          <input
            class="form-control form-control-sm"
            [(ngModel)]="filters.fullName"
            placeholder="Filter Customer"
          />
        </th>
        <th>
          <input
            class="form-control form-control-sm"
            [(ngModel)]="filters.email"
            placeholder="Filter Email"
          />
        </th>
        <th>
          <input
            class="form-control form-control-sm"
            [(ngModel)]="filters.phone"
            placeholder="Filter Phone"
          />
        </th>
        <th>
          <input
            class="form-control form-control-sm"
            [(ngModel)]="filters.totalAmount"
            placeholder="Filter Amount"
          />
        </th>
        <th>
          <select class="form-select form-select-sm" [(ngModel)]="filters.status">
            <option value="">All</option>
            <option value="PENDING_COD">PENDING_COD</option>
            <option value="OUT_FOR_DISPATCH">OUT_FOR_DISPATCH</option>
            <option value="DELIVERED">DELIVERED</option>
            <option value="CANCELLED">CANCELLED</option>
          </select>
        </th>
        <th>
          <div class="d-flex flex-column">
            <input
              type="date"
              class="form-control form-control-sm mb-1"
              [(ngModel)]="filters.createdFrom"
              placeholder="From"
            />
            <input
              type="date"
              class="form-control form-control-sm"
              [(ngModel)]="filters.createdTo"
              placeholder="To"
            />
          </div>
        </th>

        <th>
          <input
            class="form-control form-control-sm"
            [(ngModel)]="filters.address"
            placeholder="Filter Address"
          />
        </th>
        <th></th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let order of pagedOrders()">
        <td>{{ order.id }}</td>
        <td>{{ order.fullName }}</td>
        <td>{{ order.email }}</td>
        <td>{{ order.phone }}</td>
        <td>‚Çπ{{ order.totalAmount }}</td>
        <td>
          <span
            class="badge"
            [ngClass]="{
              'bg-warning': order.status === 'PENDING_COD',
              'bg-info': order.status === 'OUT_FOR_DISPATCH',
              'bg-success': order.status === 'DELIVERED',
              'bg-danger': order.status === 'CANCELLED'
            }"
          >
            {{ order.status }}
          </span>
        </td>
        <td>{{ order.createdAt | date : 'short' }}</td>
        <td>{{ order.address }}, {{ order.city }} - {{ order.zip }}</td>
        <td>
          <ul *ngIf="order.items.length > 0">
            <li *ngFor="let item of order.items">
              {{ item.productName }} ‚Äî Qty: {{ item.quantity }} ‚Äî ‚Çπ{{ item.price }}
            </li>
          </ul>
        </td>
        <td>
          <select
            class="form-select form-select-sm"
            [(ngModel)]="order.status"
            (ngModelChange)="changeStatus(order.id, $event)"
          >
            <option value="PENDING_COD">PENDING_COD</option>
            <option value="OUT_FOR_DISPATCH">OUT_FOR_DISPATCH</option>
            <option value="DELIVERED">DELIVERED</option>
            <option value="CANCELLED">CANCELLED</option>
          </select>
        </td>
      </tr>
    </tbody>
  </table>
  <div class="d-flex justify-content-between align-items-center mt-2" *ngIf="totalPages > 1">
    <button
      class="btn btn-sm btn-outline-primary"
      (click)="goToPage(currentPage - 1)"
      [disabled]="currentPage === 1"
    >
      ‚óÄ Prev
    </button>

    <span>Page {{ currentPage }} of {{ totalPages }}</span>

    <button
      class="btn btn-sm btn-outline-primary"
      (click)="goToPage(currentPage + 1)"
      [disabled]="currentPage === totalPages"
    >
      Next ‚ñ∂
    </button>
  </div>
  <div class="mt-2">
    <label>Rows per page:</label>
    <select [(ngModel)]="pageSize" class="form-select form-select-sm w-auto d-inline-block">
      <option [value]="5">5</option>
      <option [value]="10">10</option>
      <option [value]="20">20</option>
    </select>
  </div>

  <div *ngIf="orders && orders.length === 0" class="alert alert-info">No orders available.</div>
</div>
